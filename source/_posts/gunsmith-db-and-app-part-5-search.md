---
title: 'Gunsmith Db and App Part 5: Search'
tags:
  # - gunsmith db
  - MySQL
url: 543.html
id: 543
categories:
  - Personal Projects
  - GunsmithDb
date: 2016-01-29 08:00:36
---

We have already discussed the gunsmith database and app in depth.  If you want to catch up, there are posts an [overview](/gunsmith-db-and-app-part-1-overview/), [adding customers](/gunsmith-db-and-app-part-2-adding-customers/), acquisition [flow](/gunsmith-db-and-app-part-3-1-acquisition-flow/) and [code](/gunsmith-db-and-app-part-3-2-acquisition-code/), and disposition [flow](/gunsmith-db-and-app-part-4-1-disposition-flow/) and [code](/gunsmith-db-and-app-part-4-2-disposition-code/). In this post, we will go over the third and final major function of the app: searching.  Sometimes, the user may only want to search for previous acquisitions or dispositions instead of adding a new customer, gun, acquisition or disposition.![2016-01-23_18h22_33](/wp-content/uploads/2016/01/2016-01-23_18h22_33.png) The search tab looks very similar the search windows that come up with the user wants to search for a customer or a gun in the acquisition and disposition tabs.

### User Flow

The user can search by one or more of any of the available fields on the left side of the window.  If the user is unsure of the spelling, they can type partial words into any of the textboxes.  For instance, if the user types just the letter 'a' into the first name text box, all of the acquisitions and dispositions where the customer's first name contained the letter 'a' will be searched. ![2016-01-23_21h02_23](/wp-content/uploads/2016/01/2016-01-23_21h02_23.png) Additionally, the user can choose which columns are displayed by checking and unchecked the boxes along the right side of the GUI.  By default, all of the columns are shown.  To hide columns, the user unchecks the columns he or she does not want to see and clicks 'Show'. ![2016-01-23_21h06_44](/wp-content/uploads/2016/01/2016-01-23_21h06_44.png)

### Code

The query and code for the search is exactly the same as discussed in the [disposition code](/gunsmith-db-and-app-part-4-2-disposition-code/) post.  Since it is review, I'll just post the query and code here.  If you'd like a more in depth explanation, check out the previous post. \[vb\] Dim query As String = "SELECT customer.customer\_id, customer.firstname AS FirstName, customer.lastname AS LastName, customer.company AS Company, customer.address1, customer.address2, customer.city, customer.state, customer.zip, customer.licensenum, customer.phone\_number, manufacturers.name AS Manufacturer, models.name AS Model, caliber.name AS Caliber, gun.serialnum AS SerialNumber, acquisition.transaction\_date FROM gun LEFT JOIN acquisition INNER JOIN customer ON acquisition.customer\_id = customer.customer\_id ON gun.gun\_id = acquisition.gun\_id LEFT JOIN disposition ON gun.gun\_id = disposition.gun\_id LEFT JOIN manufacturers ON gun.man\_id = manufacturers.man\_id LEFT JOIN models ON gun.model\_id = models.model\_id LEFT JOIN category ON gun.cat\_id = category.cat\_id LEFT JOIN type ON gun.type\_id = type.type\_id LEFT JOIN mancountry ON gun.mancountry\_id = mancountry.mancountry\_id LEFT JOIN caliber ON gun.cal\_id = caliber.cal\_id WHERE disposition.gun\_id IS NULL " Try conn.Close() Catch ex As Exception End Try Try conn.Open() Catch ex As MySqlException MsgBox("An Error Occurred. " & ex.Number & “ – “ & ex.Message) End Try Dim adap As MySqlDataAdapter = New MySqlDataAdapter(query, conn) Dim ds As New DataSet() Dim check As Boolean = True If Not Sfname.Text = "" Then If Not check Then query += " firstname LIKE @firstname" Else query += " AND firstname LIKE @firstname" End If check = True End If If Not Slname.Text = "" Then If Not check Then query += " lastname LIKE @lastname" Else query += " AND lastname LIKE @lastname" End If check = True End If If Not Scname.Text = "" Then If Not check Then query += " company LIKE @company" Else query += " AND company LIKE @company" End If check = True End If   adap = New MySqlDataAdapter(query, conn) If Not Sfname.Text = "" Then adap.SelectCommand.Parameters.AddWithValue("@firstname", "%" + Sfname.Text + "%") End If If Not Slname.Text = "" Then adap.SelectCommand.Parameters.AddWithValue("@lastname", "%" + Slname.Text + "%") End If If Not Scname.Text = "" Then adap.SelectCommand.Parameters.AddWithValue("@company", "%" + Scname.Text + "%") End If   Try adap.Fill(ds) acq\_grid.DataSource = ds.Tables(0) ds = Nothing da = Nothing acq\_grid.Columns("customer_id").Visible = False Catch ex As MySqlException Aerror.Text = ex.ToString() Finally End Try \[/vb\] That is it for the searching.  Just as the disposition, this portion of the code was pretty quick and easy to write since most of it was very similar to things I had already done in the acquisition and disposition portions. In the next post, we'll discuss some final thoughts on the project and some ideas for future versions that I'd like to eventually implement.  If you are interested in trying out the software and looking for bugs, please [contact me](/contact/).